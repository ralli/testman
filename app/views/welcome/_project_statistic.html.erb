<% content_for :head do %>
  <%= javascript_include_tag "highcharts" %>

  <script type="text/javascript">
    function results_chart() {
      new Highcharts.Chart({
        chart: { renderTo: 'results_chart' },
				plotOptions: {
				  pie: {animation: false}
				},
				tooltip: {
						formatter: function() {
							return '<b>'+ this.point.name +'</b>: '+ this.y +' %';
						}
				},
				series: [
				   {
				      type: 'pie',
				      name: 'Test Results',
				      data: <%= raw @project_statistic.result_percentages.to_json %>
				   }
				],
				title: {
				   text: null
				},
				credits: {
				  enabled: false
				}
      });
    }

    function status_chart() {
      new Highcharts.Chart({
        chart: { renderTo: 'status_chart' },
				plotOptions: {
				  pie: { animation: false}
				},
				tooltip: {
						formatter: function() {
							return '<b>'+ this.point.name +'</b>: '+ this.y +' %';
						}
				},
				series: [
				   {
				      type: 'pie',
				      name: 'Test Status',
				      data: <%= raw @project_statistic.status_percentages.to_json %>
				   }
				],
				title: {
				   text: null
				},
				credits: {
				  enabled: false
				}
      });
    }

    $(function() {
      results_chart();
      status_chart();
    });
  </script>
  <style>
     #status_chart {
       height: 200px;
     }

     #results_chart {
       height: 200px;
     }
  </style>
<% end %>
<div class="span-24 last">
      <ul>
          <li><div  class="span-3 label">Current project:</div>  <%= @project_statistic.project_name %></li>
          <li><div  class="span-3 label">Testsuites:</div><%= as_number(@project_statistic.testsuite_count) %></li>
          <li><div class="span-3 label">Testcases:</div><%= as_number(@project_statistic.testcase_count) %></li>
          <li><div class="span-3 label">Steps:</div><%= as_number(@project_statistic.teststep_count) %></li>
      </ul>
</div>
<div class="span-24 last">
    <div class="span-12">
      <h2>Test Status</h2>
      <table>
          <thead>
            <tr>
              <th></th>
              <th>New</th>
              <th>Ended</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Testsuites</td>
              <td><%= as_number(@project_statistic.testsuiterun_status_groups['new']) %></td>
              <td><%= as_number(@project_statistic.testsuiterun_status_groups['ended']) %></td>
              <td><%= as_number(@project_statistic.testsuiterun_count) %></td>
            </tr>
            <tr>
              <td>Testcases</td>
              <td><%= as_number(@project_statistic.testcaserun_status_groups['new']) %></td>
              <td><%= as_number(@project_statistic.testcaserun_status_groups['ended']) %></td>
              <td><%= as_number(@project_statistic.testcaserun_count) %></td>
            </tr>
            <tr>
              <td>Teststeps</td>
              <td><%= as_number(@project_statistic.teststeprun_status_groups['new']) %></td>
              <td><%= as_number(@project_statistic.teststeprun_status_groups['ended']) %></td>
              <td><%= as_number(@project_statistic.teststeprun_count) %></td>
            </tr>
          </tbody>
      </table>
    </div>
    <div class="span-12 last" id="status_chart"></div>
</div>
<div class="span-24 last">
   <div class="span-12">
    <h2>Test Results</h2>
    <table>
      <thead>
        <tr>
          <th></th>
          <th>Unknown</th>
          <th>Ok</th>
          <th>Failure</th>
          <th>Total</th>
        </tr>
      </thead>
        <tbody>
          <tr>
            <td>Testsuites</td>
            <td><%= as_number(@project_statistic.testsuiterun_result_groups['unknown']) %></td>
            <td><%= as_number(@project_statistic.testsuiterun_result_groups['ok']) %></td>
            <td><%= as_number(@project_statistic.testsuiterun_result_groups['failed']) %></td>
            <td><%= as_number(@project_statistic.testsuiterun_count) %></td>
          </tr>
          <tr>
            <td>Testcases</td>
            <td><%= as_number(@project_statistic.testcaserun_result_groups['unknown']) %></td>
            <td><%= as_number(@project_statistic.testcaserun_result_groups['ok']) %></td>
            <td><%= as_number(@project_statistic.testcaserun_result_groups['failed']) %></td>
            <td><%= as_number(@project_statistic.testcaserun_count) %></td>
          </tr>
          <tr>
            <td>Teststeps</td>
            <td><%= as_number(@project_statistic.teststeprun_result_groups['unknown']) %></td>
            <td><%= as_number(@project_statistic.teststeprun_result_groups['ok']) %></td>
            <td><%= as_number(@project_statistic.teststeprun_result_groups['failed']) %></td>
            <td><%= as_number(@project_statistic.teststeprun_count) %></td>
          </tr>
        </tbody>
    </table>
  </div>
  <div class="span-12 last" id="results_chart">
  </div>
</div>

